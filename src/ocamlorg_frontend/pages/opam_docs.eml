open Ocamlorg

let rec doc_toc_to_toc (toc : Data.OpamDocs.toc) =
  Toc.{
    title = toc.title;
    href = toc.href;
    children = List.map doc_toc_to_toc toc.children
  }

let right_sidebar
(doc : Data.OpamDocs.t)
=
  <%s! Toc.render (List.map doc_toc_to_toc doc.toc) %>

let render
(doc : Data.OpamDocs.t)
~docs
=
Learn_layout.render
~title:(Printf.sprintf "%s Â· OCaml Documentation" doc.title)
~description:doc.description
~canonical:(Url.opam_docs doc.version doc.slug)
~active_top_nav_item:Learn
~left_sidebar_html:(Some(Platform_tool.sidebar ~docs ~doc_slug:(Some doc.slug) ~tool_slug:(Some "opam")))
~right_sidebar_html:(Some(right_sidebar doc))
~current:Platform @@
  <div class="prose prose-orange max-w-full">
    <%s! doc.body_html %>
    <div class="pt-10 border-t border-slate-200 lg:grid lg:grid-cols-3 gap-4 text-slate-500">
      <div class="mt-4 lg:mt-0 lg:col-span-1 lg:col-start-3">
        <h2 class="mt-0 mb-4 text-base font-semibold leading-6 lg:text-base">Still need help?</h2>
        <div class="text-sm mb-2">
          <a href="https://discuss.ocaml.org/" class="font-semibold no-underline bg-transparent cursor-pointer hover:underline">
            <%s! Icons.community "inline h-4 w-4" %>
            Ask the OCaml Community</a
          >
        </div>
        <div class="text-sm mb-2">
          <a href="https://github.com/ocaml/ocaml.org/issues/new" class="font-semibold no-underline bg-transparent cursor-pointer hover:underline">
            <%s! Icons.github_issue "inline h-4 w-4" %>
            Open an Issue</a
          >
        </div>
      </div>
    </div>
  </div>
