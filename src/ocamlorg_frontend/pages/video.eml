let hyphens text =
  if String.length text <= 150 then text
  else
    let space = Option.value (String.rindex_from_opt text 149 ' ') ~default:149 in
    String.sub text 0 (space + 1) ^ "..."

let render ~(videos: Data.Video.t list) =
Community_layout.single_column_layout
~title:"Community Videos"
~description:"Videos from the OCaml Community"
~canonical:Url.video
~current:Videos @@
<div class="intro-section-simple dark:dark-intro-section-simple py-12 border-b border-solid border-separator_20 dark:border-dark-separator_30">
  <div class="container-fluid">
    <div class="flex items-center">
      <h1 class="m-0 font-sans text-3xl font-extrabold tracking-normal leading-8 capitalize lg:text-5xl lg:tracking-tight md:text-4xl text-title dark:text-dark-title">
        OCaml Videos
      </h1>
      <a href="/video.xml" class="text-content dark:text-dark-title hover:text-primary dark:hover:text-dark-primary ml-4 lg:ml-6">
        <span class="sr-only">RSS</span>
        <%s! Icons.rss "h-6 w-6 md:h-8 md:w-8 lg:h-10 lg:w-10" %>
      </a>
    </div>
    <div class="py-6 leading-5 text-content dark:text-dark-content">
      <p class="text-lg text-content dark:text-dark-content mt-6">A curated list of videos on the OCaml from the community.</p>
    </div>
  </div>
</div>
<div class="bg-background dark:bg-dark-background py-12">
  <div class="container-fluid">
    <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-8">
% videos |> List.iter (fun (video: Data.Video.t) -> 
      <%s! Cards.community_resource
        ~title:video.title
        ~desc:(hyphens video.description)
        ~online_url:video.content
        ~source_url:None
        ~img:video.thumbnail
        ()
      %>
% );
    </div>
  </div>
</div>
