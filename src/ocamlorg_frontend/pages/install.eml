let render () =
Layout.render
~use_swiper:true
~title:"Install OCaml"
~description:"Quick setup instructions to install OCaml on your system."
~canonical:"" @@
<div class="lg:py-16 py-6">
  <div class="container-fluid" x-data='{ operating_system: detect_os () }'>
    <div class="prose">
      <h1>
        Install OCaml
      </h1>
      <div class="flex gap-2">
        <button class="btn flex gap-2" :class='operating_system == "linux"? "": "btn-secondary"' @click="operating_system = 'linux'"><%s! Icons.linux_tux "w-6 h-6" %> Linux</button>
        <button class="btn flex gap-2" :class='operating_system == "mac"? "": "btn-secondary"' @click="operating_system = 'mac'"><%s! Icons.apple_logo "w-6 h-6" %> macOS</button>
        <button class="btn flex gap-2" :class='operating_system == "win"? "": "btn-secondary"' @click="operating_system = 'win'"><%s! Icons.microsoft_windows "w-6 h-6" %> Windows</button>
      </div>

      <p>If the instructions below do not work for you, you can find
        <a href="<%s Url.getting_started %>">a more detailed explanation of OCaml installation methods here</a>.</p>

      <div x-show="(operating_system == 'unix') || (operating_system == 'linux') || (operating_system == 'mac')">
        <h2>
          Instructions for Linux, BSD, or macOS
        </h2>
        <ol>
          <li>
            <h3>Install the <code>opam</code> package manager</h3>

            <p>
            To download and install the most recent version of <code>opam</code>, run the following in your terminal, then follow the on-screen instructions:
            </p>

            <%s! Copy_to_clipboard_snippet.render ~id:"install-opam" "curl -fsSL https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh | sh" %>
            <a href="https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh" class="flex justify-end gap-1 py-1 items-center"><%s! Icons.github "h-6 w-6" %> view this shell script on GitHub</a>

            <details>
              <summary class="flex items-center gap-2 py-2 font-semibold">
                What if I don't like shell scripts?
                <%s! Icons.chevron_right "h-4 w-4" %>
              </summary>
              Alternatively, you could <a href="<%s Url.tutorial "up-and-running" %>#1-install-opam">install <tt>opam</tt> using your distribution's package manager</a>.

              Or, if you want to have the most recent version of <code>opam</code>,
              you could follow the instructions at <a href="https://github.com/ocaml/opam"><tt>opam</tt>'s GitHub repository</a>
              to build <code>opam</code> from sources.
            </details>
          </li>

          <li>
            <h3>Create an <code>opam</code> switch</h3>

            <p>
              An <code>opam</code> switch is an isolated environment for the OCaml compiler
              and any packages you install.
              The following command installs OCaml 5.0.0 in a global <code>opam</code> switch:
            </p>

            <%s! Copy_to_clipboard_snippet.render ~id:"create-opam-switch" "opam switch create 5.0.0" %>

            <p>
              You can use <code>opam switch list-available</code> to see all available compiler versions.
            </p>

          </li>
        </ol>

        <p>Congratulations, you have installed OCaml!</p>

        <h2>Install the OCaml Platform Tools in Your <code>opam</code> Switch</h2>

        <p>
          The <a href="<%s Url.tutorial "up-and-running" %>#installing-the-ocaml-platform-tools">OCaml Platform Tools</a>
          complete your OCaml development environment. To install them, run this command:
        </p>

        <%s! Copy_to_clipboard_snippet.render ~id:"install-platform-tools" "opam install dune merlin ocaml-lsp-server odoc ocamlformat utop dune-release" %>

        <p>Now you are ready to write some OCaml code!</p>
      </div>

      <div x-show="operating_system == 'win'">
        <h2>
          Instructions for Windows
        </h2>
        <ol>
          <li>
            <h3>Use the Diskuv OCaml ("DKML") Windows installer</h3>
              <p>
                The installer sets up OCaml 4.14.0 with Git and the Visual Studio compiler.
              </p>

              <a class="btn !text-white hover:no-underline" href="https://github.com/diskuv/dkml-installer-ocaml/releases/download/v1.1.0_r2/setup-diskuv-ocaml-windows_x86_64-1.1.0.exe">
                <%s! Icons.download "h-6 w-6" %> Download DKML Installer
              </a>

              <p>
                Currently, 4.14.0 is the only OCaml version available through the Diskuv OCaml Installer.
                If you need a different OCaml version, check out the alternative installation instructions
                provided in <a href="<%s Url.ocaml_on_windows %>">"OCaml on Windows"</a>.
              </p>
          </li>
          <li>
            <h3>Create an <code>opam</code> switch</h3>

            <p>
              An <code>opam</code> switch is an isolated environment for the OCaml compiler
              and any packages you install.
              The following command creates a new <code>opam</code> switch with OCaml 4.14.0
              in the current directory:
            </p>

            <%s! Copy_to_clipboard_snippet.render ~id:"win-create-opam-switch" "dkml init" %>
          </li>
          <li>
            <h3>Activate the <code>opam</code> switch</h3>
            <p>If using the Windows Command Prompt:</p>

            <%s! Copy_to_clipboard_snippet.render ~id:"win-create-opam-switch2" "for /f \"tokens=*\" %i in ('opam env') do @%i" %>

            <p>If using the Windows Power Shell:</p>

            <%s! Copy_to_clipboard_snippet.render ~id:"win-create-opam-switch3" "(& opam env) -split '\r?\n' | ForEach-Object { Invoke-Expression $_ }" %>
          </li>
        </ol>

        <p>Congratulations, you have installed OCaml!</p>

        <h2>Install the OCaml Platform Tools in Your <code>opam</code> Switch</h2>

        <p>
          The <a href="<%s Url.tutorial "up-and-running" %>#installing-the-ocaml-platform-tools">OCaml Platform Tools</a>
          complete your OCaml development environment. To install them, run these commands:
        </p>

        <%s! Copy_to_clipboard_snippet.render ~id:"win-install-platform-tools" ~class_:"mb-4" "opam pin remove fiber omd stdune dyn ordering dot-merlin-reader yojson --no-action" %>

        <%s! Copy_to_clipboard_snippet.render ~id:"win-install-platform-tools2" "opam install dune merlin ocaml-lsp-server odoc ocamlformat utop" %>

        <p>Now you are ready to write some OCaml code!</p>
      </div>
    </div>

    <a class="btn text-white mt-6 flex gap-2" href="<%s Url.tutorial "up-and-running" %>#first-steps-with-ocaml">First Steps with OCaml <%s! Icons.arrow_small_right "h-6 w-6" %></a>
  </div>
</div>
<script>
function detect_os ()
{
    let os = navigator.userAgent;
    let result="unix"; // assume a generic unix as default
    if (os.search('Win')!==-1){
        result="win";
    }
    else if (os.search('Mac')!==-1){
        result="mac";
    }
    else if (os.search('X11')!==-1 && !(os.search('Linux')!==-1)){
        result="unix";
    }
    else if (os.search('Linux')!==-1 && os.search('X11')!==-1){
        result="linux"
    }
    return result;
}
</script>