let skill_tag difficulty class_ =
  match difficulty with 
  | Some "beginner" ->
    <div class="<%s class_ %> px-2 py-1 inline-block bg-teal-700 rounded-3xl border-2 border-teal-700 font-normal text-center text-white"> Beginner  </div>
  | Some "intermediate" -> 
    <div class="<%s class_ %> px-2 py-1 inline-block bg-[#040113] rounded-3xl border-2 border-[#040113] font-normal text-center text-white"> Intermediate </div>
  | Some "advanced" -> 
    <div class="<%s class_ %> px-2 py-1 inline-block bg-learn-area-orange rounded-3xl border-2 border-learn-area-orange font-normal text-center text-white"> Advanced </div>
  | None -> 
    <></> 
  | Some _ -> 
    <></>

let beginner_section_icon =
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="10" fill="#2B7866"/>
  </svg>

let intermediate_section_icon =
  <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M0.5 6.5C0.5 3.18629 3.18629 0.5 6.5 0.5H18.5C21.8137 0.5 24.5 3.18629 24.5 6.5V18.5C24.5 21.8137 21.8137 24.5 18.5 24.5H6.5C3.18629 24.5 0.5 21.8137 0.5 18.5V6.5Z" fill="#3882B7"/>
  </svg>

let advanced_section_icon =
  <svg width="26" height="23" viewBox="0 0 26 23" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M11.268 1.5C12.0378 0.166665 13.9622 0.166667 14.7321 1.5L25.1244 19.5C25.8942 20.8333 24.9319 22.5 23.3923 22.5H2.60769C1.06809 22.5 0.105844 20.8333 0.875645 19.5L11.268 1.5Z" fill="#D54000"/>
  </svg>

let little_down_arrow_icon =
  <svg width="18" height="32" viewBox="0 0 18 32" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M13 16.6L9 20.6M9 20.6L5 16.6M9 20.6V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>

let download_icon class_ =
  <svg xmlns="http://www.w3.org/2000/svg" class="<%s class_ %>" fill="none" viewBox="0 0 24 24" stroke-width="0.5" stroke="currentColor" class="w-6 h-6" aria-hidden="true">
    <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 7.5h-.75A2.25 2.25 0 004.5 9.75v7.5a2.25 2.25 0 002.25 2.25h7.5a2.25 2.25 0 002.25-2.25v-7.5a2.25 2.25 0 00-2.25-2.25h-.75m-6 3.75l3 3m0 0l3-3m-3 3V1.5m6 9h.75a2.25 2.25 0 012.25 2.25v7.5a2.25 2.25 0 01-2.25 2.25h-7.5a2.25 2.25 0 01-2.25-2.25v-.75" />
  </svg>

let command_line_icon class_ =
  <svg xmlns="http://www.w3.org/2000/svg" class="<%s class_ %>" fill="none" viewBox="0 0 24 24" stroke-width="0.5" stroke="currentColor" class="w-6 h-6" aria-hidden="true">
    <path stroke-linecap="round" stroke-linejoin="round" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>

let hero_button ~left_icon ~right_icon ~text ~href =
  <a href="<%s href %>" class="group whitespace-nowrap flex p-3 gap-2 items-center bg-white hover:bg-primary hover:text-white drop-shadow hover:drop-shadow-xl border-primary border-2 rounded-lg px-4 text-text_title">
    <span class="group-hover:text-white text-primary"><%s! left_icon %></span>
    <span class="flex-grow"><%s text %></span>
    <%s! right_icon %>
  </a>

type link = {href : string; title : string}

let tutorial_block ~icon ~title ~heading ~description ~(tutorial_links: link list) ~see_more  =
  <div class="flex h-full">
    <div class="w-full flex flex-col h-full max-w-sm md:max-w-none md:w-96">
      <div class="mt-4 flex gap-2 items-center text-text_title text-sm font-medium leading-7 tracking-widest"><%s! icon %> <%s title %> </div>
      <h2 class="mt-2 text-text_title text-2xl font-bold leading-7"> <%s heading %> </h2>
      <div class="mt-4 text-text_content text-md font-normal leading-7 max-w-prose"> <%s description %> </div>
      <ul class="flex flex-col gap-4 mt-5">
        <% tutorial_links |> List.iter (fun link -> %>
        <li class="w-full">
          <a href="<%s link.href %>" class="bg-white text-text_title hover:bg-primary hover:text-white drop-shadow hover:drop-shadow-xl flex gap-2 border-primary border-2 rounded-lg p-2.5 text-md font-bold">
            <span class="flex-grow"><%s link.title  %></span>

            <%s! Icons.arrow_right_circle "w-6 h-6" %>
          </a>
        </li>
        <% ); %>
      </ul>
      <a href="<%s see_more.href %>" class="mt-4 text-primary hover:underline items-center leading-10"> 
        <%s see_more.title %>
      </a>
    </div>
  </div>

let pricing_tag = 
  <div class="absolute -mt-3 ml-3 w-16 h-16">
    <div class="bg-learn-area-orange rotate-[-10deg] rounded-full w-16 h-16 flex items-center justify-center" style="filter: drop-shadow(-4px -2px 4px rgb(0 0 0 / 0.25));">
      <div class="text-center text-white text-base font-bold leading-7 tracking-wide">
        FREE
      </div>
    </div>
  </div>

let book_tile 
books
= 
  <div class="mt-2 flex flex-col flex-grow gap-12 lg:gap-6 md:flex-row xl:gap-12">
    <% books |> List.rev |> List.iteri (fun index (item : Data.Book.t) -> if (index < 2) then ( %>  
        <div class="flex flex-col w-full gap-4 lg:w-60">
          <img src="<%s Ocamlorg_static.Media.url item.cover %>" 
                  class="mt-2 w-60 h-80 lg:w-52 lg:h-72 xl:w-60 xl:h-80 
                    <%s if item.difficulty = Some "intermediate" then "bg-[#040113]" else "bg-teal-700" %> object-contain"
                  alt="">
          <%s! skill_tag item.difficulty "mt-2 grow-0 w-28" %>
          <h4 class="mt-1 text-legacy-default text-lg font-normal leading-6"> <%s item.title %> </h4>
          <% (match item.recommendation with None -> () | Some recommendation -> %>
          <p class="mt-1 text-gray-700 text-sm font-normal whitespace-normal max-w-prose"> <%s recommendation %> </p>
          <% ); %>
        </div>
      <% ) else %> 
    <% ); %>
  </div>

let left_books_content_block books ~title ~(link : link) =
  <div class="w-full bg-legacy-default flex h-full p-4">
    <div class="max-w-sm md:max-w-none sm:w-96 md:w-auto ml-auto flex flex-col mr-auto lg:ml-auto lg:mr-0 lg:pr-4 md:pl-20 lg:pl-0">
      <div class="pt-4 text-legacy-default text-sm font-medium leading-7 tracking-widest"> BOOKS </div>
      <h2 class="mt-2 text-legacy-default text-2xl font-normal leading-7"> <%s title %> </h2>
      <%s! book_tile books %>
      <a href="<%s link.href %>" class="flex gap-4 mt-4 text-legacy-primary-700 text-lg font-bold inline-flex items-center underline leading-10"> 
        <%s link.title %>
        <%s! Icons.arrow_small_right "h-6 w-6" %>
      </a>
    </div>
  </div>

let right_books_content_block books ~title ~(link : link) =
  <div class="w-full bg-legacy-default flex h-full p-4">
    <div class="max-w-sm md:max-w-none sm:w-96 md:w-auto ml-auto mr-auto flex flex-col lg:ml-0 lg:mr-auto lg:pl-6 md:pl-20 lg:pl-0">
      <div class="pt-4 text-legacy-default text-sm font-medium leading-7 tracking-widest"> BOOKS </div>
      <h2 class="mt-2 text-legacy-default text-2xl font-normal leading-7"> <%s title %> </h2>
      <%s! book_tile books %>
      <a href="<%s link.href %>" class="flex gap-4 mt-4 text-legacy-primary-700 text-lg font-bold inline-flex items-center underline leading-10"> 
        <%s link.title %>
        <%s! Icons.arrow_small_right "h-6 w-6" %>
      </a>
    </div>
  </div>

let contribute_footer ~href =
  <div class="pt-10 mt-16 border-t border-slate-200 lg:grid lg:grid-cols-3 gap-4 text-slate-500">
    <div class="lg:col-span-1">
      <h2 class="mt-0 mb-4 text-base font-semibold leading-6 lg:text-base">Help Improve Our Documentation</h2>
      <p class="text-sm mt-0 mb-4 max-w-xs">All OCaml docs are open source. See something that's wrong or unclear? Submit a pull request.</p>
      <a
        class="inline-block relative py-1 px-4 font-medium no-underline align-middle bg-transparent rounded-md border border-solid appearance-none cursor-pointer select-none whitespace-no-wrap hover:no-underline"
        href="<%s href %>"
      >
        <%s! Icons.github_pull_request "inline-block overflow-visible mr-0 align-text-bottom select-none" %>
        Contribute</a
      >
    </div>
    <div class="mt-4 lg:mt-0 lg:col-span-1 lg:col-start-3">
      <h2 class="mt-0 mb-4 text-base font-semibold leading-6 lg:text-base">Still need help?</h2>
      <div class="text-sm mb-2">
        <a href="https://discuss.ocaml.org/" class="font-semibold no-underline bg-transparent cursor-pointer hover:underline">
          <%s! Icons.community "inline h-4 w-4" %>
          Ask the OCaml Community</a
        >
      </div>
      <div class="text-sm mb-2">
        <a href="https://github.com/ocaml/ocaml.org/issues/new" class="font-semibold no-underline bg-transparent cursor-pointer hover:underline">
          <%s! Icons.github_issue "inline h-4 w-4" %>
          Open an Issue</a
        >
      </div>
    </div>
  </div>

let lang_manual_banner =
  <div class="bg-learn-area-orange flex w-full flex-col items-center justify-center px-3 py-5 sm:px-16 md:flex-row gap-6 md:gap-x-16 lg:gap-x-20 lg:px-20 xl:gap-x-36 xl:px-48">
    <div class="mb-2 flex flex-col items-start max-w-sm md:max-w-none">
      <h2 class="mb-2 text-white text-center text-sm font-medium leading-5 tracking-widest md:text-left lg:leading-7">GUIDE</h2>
      <h3 class="mb-4 text-white text-center text-lg font-normal leading-5 md:leading-10 md:text-xl lg:text-2xl md:text-left">Language Manual</h3>
      <p class="mb-4 text-white text-sm font-normal leading-5 max-w-prose md:text-md lg:leading-7 xl:text-lg">OCaml language manuals are comprehensive guides covering syntax, features, and usage. They assist developers and learners in understanding capabilities, best practices, and exploring functionalities.</p>
      <a href="<%s Url.manual %>" class="w-full md:w-auto mt-5 py-2 px-24 bg-legacy-default text-sm rounded-sm items-center text-center text-legacy-primary-700 sm:px-20 sm:text-md font-medium leading-7 md:text-lg">Take Me There</a>
    </div>
    <div class="min-w-[200px] min-h-[200px] overflow-hidden rounded-full bg-cover bg-center bg-no-repeat md:min-w-[240px] md:min-h-[240px]" style="background-image: url('../img/home/ocaml_camel.png')">
    </div>
  </div>
