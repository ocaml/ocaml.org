---
title: 3.21.0~alpha3
tags:
- dune
- platform
authors: []
contributors:
changelog:
versions:
experimental: false
ignore: false
released_on_github_by: shonfeder
github_release_tags:
- 3.21.0_alpha3
---

<p>CHANGES:</p>
<h3>Fixed</h3>
<ul>
<li>
<p>Fix <code>include_subdirs qualified</code> incorrectly picking the furthest module<br>
instead of the closest when resolving module name ambiguities. (<a href="https://github.com/ocaml/dune/pull/12587" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3525645064" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12587" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12587/hovercard">#12587</a>,<br>
<a href="https://github.com/ElectreAAS" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ElectreAAS/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@ElectreAAS</a> and <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p>Fix: include the module alias in the transitive dependency closure with<br>
<code>(include_subdirs qualified)</code>. (<a href="https://github.com/ocaml/dune/pull/12299" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3350469289" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12299" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12299/hovercard">#12299</a>, <a href="https://github.com/anmonteiro" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/anmonteiro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@anmonteiro</a>)</p>
</li>
<li>
<p>Improve error messages for invalid version formats containing non-ASCII<br>
characters. Previously, non-ASCII characters in version strings (e.g., <code>(lang dune è)</code> or <code>(using menhir π3.14)</code>) would fail with a generic "Invalid file"<br>
error. Now they display a clear message: "Invalid atom: contains non-ASCII<br>
character(s). Atoms must only contain ASCII characters." The fix is<br>
implemented at the lexer level, providing consistent error handling across all<br>
s-expression parsing. (<a href="https://github.com/ocaml/dune/pull/12844" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3684905054" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12844" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12844/hovercard">#12844</a>, fixes <a href="https://github.com/ocaml/dune/issues/12836" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3681408925" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12836" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12836/hovercard">#12836</a>, <a href="https://github.com/benodiwal" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/benodiwal/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@benodiwal</a>)</p>
</li>
<li>
<p>Pass private modules with -H when this is available (<a href="https://github.com/ocaml/dune/pull/12666" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3577887853" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12666" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12666/hovercard">#12666</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Allow multiple modules in <code>(modules_flags ...)</code>, in <code>coq.theory</code> (<a href="https://github.com/ocaml/dune/pull/12733" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3630621281" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12733" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12733/hovercard">#12733</a>, <a href="https://github.com/rlepigre" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rlepigre/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rlepigre</a>)</p>
</li>
<li>
<p>Improve error message for invalid version formats in both <code>(lang dune ...)</code> and<br>
<code>(using extension ...)</code> declarations. Changes "Atom of the form NNN.NNN expected"<br>
to "Invalid version. Version must be two numbers separated by a dot." (<a href="https://github.com/ocaml/dune/pull/12833" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3680166388" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12833" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12833/hovercard">#12833</a>, <a href="https://github.com/benodiwal" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/benodiwal/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@benodiwal</a>)</p>
</li>
<li>
<p>Fix crash when running <code>dune build @check</code> on a library with virtual modules.<br>
(<a href="https://github.com/ocaml/dune/pull/12644" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3560725568" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12644" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12644/hovercard">#12644</a>, fixes <a href="https://github.com/ocaml/dune/issues/12636" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3557347727" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12636" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12636/hovercard">#12636</a>, <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p>Provide a more informative error message when <code>(pkg enabled)</code> is put in<br>
<code>dune-project</code> instead of <code>dune-workspace</code>. (<a href="https://github.com/ocaml/dune/pull/12802" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3671647078" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12802" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12802/hovercard">#12802</a>, fixes <a href="https://github.com/ocaml/dune/issues/12801" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3671325202" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12801" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12801/hovercard">#12801</a>,<br>
<a href="https://github.com/benodiwal" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/benodiwal/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@benodiwal</a>)</p>
</li>
<li>
<p>Improve error message when invalid version strings are used in <code>dune-project</code><br>
files. Non-ASCII characters and malformed versions now show a helpful hint<br>
with an example of the correct format. (<a href="https://github.com/ocaml/dune/pull/12794" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3669442524" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12794" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12794/hovercard">#12794</a>, fixes <a href="https://github.com/ocaml/dune/issues/12751" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3642929276" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12751" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12751/hovercard">#12751</a>, <a href="https://github.com/benodiwal" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/benodiwal/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@benodiwal</a>)</p>
</li>
<li>
<p>Stop hiding the <code>root_module</code> from the include path (<a href="https://github.com/ocaml/dune/pull/12239" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3339595667" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12239" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12239/hovercard">#12239</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Allow <code>$ dune init</code> to work on absolute paths (<a href="https://github.com/ocaml/dune/pull/12601" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3530217253" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12601" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12601/hovercard">#12601</a>, fixes <a href="https://github.com/ocaml/dune/issues/7806" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1727216728" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/7806" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/7806/hovercard">#7806</a>,<br>
<a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p><code>(include_subdirs qualified)</code>: Add missing alias dependency to module group.<br>
(<a href="https://github.com/ocaml/dune/pull/12530" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3484313448" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12530" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12530/hovercard">#12530</a>, <a href="https://github.com/anmonteiro" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/anmonteiro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@anmonteiro</a>)</p>
</li>
<li>
<p>Add Melange compilation to the <code>@all</code> alias in libraries (<a href="https://github.com/ocaml/dune/pull/12628" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3553013744" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12628" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12628/hovercard">#12628</a>,<br>
<a href="https://github.com/anmonteiro" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/anmonteiro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@anmonteiro</a>)</p>
</li>
<li>
<p>Fix greedy version location in lang declarations. Previously, error locations for<br>
invalid lang versions would span multiple bytes for multi-byte UTF-8 characters,<br>
causing carets to appear misaligned and seemingly include the closing<br>
parenthesis. Now, error locations for ASCII strings show the full length (e.g.,<br>
"Ali" shows <code>^^^</code>), while non-ASCII strings show only the first byte (e.g., "è"<br>
shows <code>^</code>) to avoid multi-byte character display issues. (<a href="https://github.com/ocaml/dune/pull/12869" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3699103715" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12869" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12869/hovercard">#12869</a>, fixes <a href="https://github.com/ocaml/dune/issues/12806" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3672632589" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12806" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12806/hovercard">#12806</a>,<br>
<a href="https://github.com/benodiwal" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/benodiwal/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@benodiwal</a>)</p>
</li>
<li>
<p>melange support: don't emit empty JavaScript modules for generated module<br>
aliases. (<a href="https://github.com/ocaml/dune/pull/12464" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3416445223" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12464" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12464/hovercard">#12464</a>, <a href="https://github.com/anmonteiro" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/anmonteiro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@anmonteiro</a>)</p>
</li>
</ul>
<h3>Added</h3>
<ul>
<li>
<p>(Experimental): Introduce the <code>library_parameter</code> stanza. It allows users to<br>
declare a parameter when using the OxCaml compiler.<br>
(<a href="https://github.com/ocaml/dune/pull/11963" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3199543403" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/11963" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/11963/hovercard">#11963</a>, implements <a href="https://github.com/ocaml/dune/issues/12084" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3270049675" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12084" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12084/hovercard">#12084</a>, <a href="https://github.com/maiste" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/maiste/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@maiste</a>)</p>
</li>
<li>
<p>Added the ability to scroll horizontally in TUI. (<a href="https://github.com/ocaml/dune/pull/12386" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3373547394" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12386" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12386/hovercard">#12386</a>, <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p>Feature: Include shell command that was executed when a cram test has<br>
occurred in the error message (<a href="https://github.com/ocaml/dune/pull/12307" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3352991749" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12307" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12307/hovercard">#12307</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>support expanding variables in <code>(promote (into ..))</code> (<a href="https://github.com/ocaml/dune/pull/12832" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3679249904" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12832" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12832/hovercard">#12832</a>, fixes <a href="https://github.com/ocaml/dune/issues/12742" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3637887258" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12742" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12742/hovercard">#12742</a>,<br>
<a href="https://github.com/anmonteiro" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/anmonteiro/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@anmonteiro</a>)</p>
</li>
<li>
<p>Add support for <code>%{cmt:...}</code> and <code>%{cmti:...}</code> variables to reference<br>
compiled annotation files (.cmt and .cmti) containing typed abstract syntax<br>
trees with location and type information. (<a href="https://github.com/ocaml/dune/pull/12634" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3556976158" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12634" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12634/hovercard">#12634</a>, grants <a href="https://github.com/ocaml/dune/issues/12633" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3556528586" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12633" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12633/hovercard">#12633</a>, <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p>Add <code>$ dune describe tests</code> to describe the tests in the workspace<br>
(<a href="https://github.com/Gromototo" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Gromototo/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Gromototo</a>, <a href="https://github.com/ocaml/dune/pull/12545" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3498317882" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12545" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12545/hovercard">#12545</a>, fixes <a href="https://github.com/ocaml/dune/issues/12030" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3236489811" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12030" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12030/hovercard">#12030</a>)</p>
</li>
<li>
<p>Add <code>argv</code>, the process environment, and the dune version to the config event<br>
in the trace (<a href="https://github.com/ocaml/dune/pull/12909" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3714271058" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12909" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12909/hovercard">#12909</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Allow <code>dune runtest</code> to properly run while a watch mode server is running.<br>
(<a href="https://github.com/ocaml/dune/pull/12473" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3427218053" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12473" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12473/hovercard">#12473</a>, grants <a href="https://github.com/ocaml/dune/issues/8114" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1789828196" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/8114" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/8114/hovercard">#8114</a>, <a href="https://github.com/gridbugs" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/gridbugs/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@gridbugs</a> and <a href="https://github.com/ElectreAAS" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ElectreAAS/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@ElectreAAS</a>)</p>
</li>
<li>
<p>Use copy-on-write (COW) when copying files on filesystems that support it<br>
(Btrfs, ZFS, XFS, etc), under Linux. (<a href="https://github.com/ocaml/dune/pull/12074" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3262383074" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12074" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12074/hovercard">#12074</a>, fixes <a href="https://github.com/ocaml/dune/issues/12071" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3259374228" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12071" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12071/hovercard">#12071</a>, <a href="https://github.com/nojb" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/nojb/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@nojb</a>)</p>
</li>
<li>
<p>Add support for Tangled ATproto-based code repositories (<a href="https://github.com/ocaml/dune/pull/12197" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3328062819" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12197" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12197/hovercard">#12197</a>, <a href="https://github.com/avsm" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/avsm/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@avsm</a>)</p>
</li>
<li>
<p>Add support for instantiating OxCaml parameterised libraries.<br>
(<a href="https://github.com/ocaml/dune/pull/12561" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3509388563" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12561" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12561/hovercard">#12561</a>, <a href="https://github.com/art-w" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/art-w/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@art-w</a>)</p>
</li>
<li>
<p>Add a <code>(conflict_markers error|ignore)</code> option to the cram stanza. When<br>
<code>(conflict_markers error)</code> is set, the cram test will fail in the presence of<br>
conflict markers. Git, diff3 and jujutsu conflict markers are detected.<br>
(<a href="https://github.com/ocaml/dune/pull/12538" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3488088173" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12538" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12538/hovercard">#12538</a>, <a href="https://github.com/ocaml/dune/pull/12617" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3546343654" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12617" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12617/hovercard">#12617</a>, <a href="https://github.com/ocaml/dune/pull/12655" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3568358308" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12655" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12655/hovercard">#12655</a>, fixes <a href="https://github.com/ocaml/dune/issues/12512" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3460425491" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12512" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12512/hovercard">#12512</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>, <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p>Introduce a <code>%{ppx:lib1+..+libn}</code> stanza to make it possible to refer to ppx<br>
executables built by dune. This is useful for writing tests (<a href="https://github.com/ocaml/dune/pull/12711" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3614066236" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12711" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12711/hovercard">#12711</a>,<br>
<a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Introduce a <code>(dir ..)</code> field on packages defined in the <code>dune-project</code>. This<br>
field allows to associate a directory with a particular package. This makes<br>
dune automatically filter out all stanzas in this directory and its<br>
descendants with <code>--only-packages</code>. All users are recommended to switch to<br>
using this field. (<a href="https://github.com/ocaml/dune/pull/12614" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3541398057" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12614" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12614/hovercard">#12614</a>, fixes <a href="https://github.com/ocaml/dune/issues/3255" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="578679960" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/3255" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/3255/hovercard">#3255</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Add support for <code>DUNE_ROOT</code> environment variable, similar to the existing<br>
<code>--root</code> CLI parameter. (fixes <a href="https://github.com/ocaml/dune/issues/12399" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3387926301" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12399" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/12399/hovercard">#12399</a> <a href="https://github.com/sir4ur0n" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/sir4ur0n/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@sir4ur0n</a>)</p>
</li>
<li>
<p>Introduce an <code>unused-libs</code> alias to detect unused libraries.<br>
(<a href="https://github.com/ocaml/dune/pull/12623" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3551585780" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12623" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12623/hovercard">#12623</a>, fixes <a href="https://github.com/ocaml/dune/issues/650" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="307966874" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/650" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/650/hovercard">#650</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Add <code>--files</code> flag to <code>dune describe opam-files</code> to print only the names of<br>
the opam files line by line. (<a href="https://github.com/ocaml/dune/pull/9793" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="2093393406" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/9793" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/9793/hovercard">#9793</a>, <a href="https://github.com/reynir" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/reynir/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@reynir</a> and <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p><code>dune exec</code> now accepts absolute paths inside the workspace.<br>
(<a href="https://github.com/ocaml/dune/pull/12094" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3271636689" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12094" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12094/hovercard">#12094</a>, <a href="https://github.com/Alizter" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Alizter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Alizter</a>)</p>
</li>
<li>
<p>Add <code>coqdoc_header</code> and <code>coqdoc_footer</code> fields to the <code>coq</code> field of the<br>
<code>env</code> stanza, and to the <code>coq.theory</code> stanza, allowing to configure a<br>
custom header or footer respectively in the HTML output of <code>coqdoc</code>.<br>
(<a href="https://github.com/ocaml/dune/pull/11131" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="2670188441" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/11131" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/11131/hovercard">#11131</a>, <a href="https://github.com/rlepigre" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rlepigre/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rlepigre</a>)</p>
</li>
<li>
<p>Allow <code>dune fmt</code> to properly run while a watch mode server is running.<br>
Note that the <code>--preview</code> flag is not supported in this mode.<br>
(<a href="https://github.com/ocaml/dune/pull/12064" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3252874282" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12064" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12064/hovercard">#12064</a>, <a href="https://github.com/ElectreAAS" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ElectreAAS/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@ElectreAAS</a>)</p>
</li>
<li>
<p>Support for generating <code>_CoqProject</code> files for <code>coq.theory</code> stanzas.<br>
(<a href="https://github.com/ocaml/dune/pull/11752" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3037973751" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/11752" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/11752/hovercard">#11752</a>, <a href="https://github.com/rlepigre" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rlepigre/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rlepigre</a>)</p>
</li>
<li>
<p>Added <code>(files)</code> stanza, similar to <code>(dirs)</code> to control which files are visible<br>
to Dune on a per-directory basis. (<a href="https://github.com/ocaml/dune/pull/12879" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3701974978" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12879" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12879/hovercard">#12879</a>, <a href="https://github.com/nojb" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/nojb/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@nojb</a>)</p>
</li>
<li>
<p>Add support for %{ocaml-config:ox} (<a href="https://github.com/ocaml/dune/pull/12236" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3338767565" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12236" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12236/hovercard">#12236</a>, <a href="https://github.com/jonludlam" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/jonludlam/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@jonludlam</a>)</p>
</li>
<li>
<p>Introduce <code>dune promotion show</code> command to display the contents of corrected<br>
files that are ready for promotion. This allows users to preview changes<br>
before running <code>dune promote</code>. The command accepts file arguments to show<br>
specific files, or displays all promotable files when called without<br>
arguments. (<a href="https://github.com/ocaml/dune/pull/12669" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3581958498" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12669" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12669/hovercard">#12669</a>, fixes <a href="https://github.com/ocaml/dune/issues/3883" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="726537903" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/3883" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/3883/hovercard">#3883</a>, <a href="https://github.com/MixiMaxiMouse" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/MixiMaxiMouse/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@MixiMaxiMouse</a>)</p>
</li>
<li>
<p>New <code>(lang rocq)</code> build mode for Rocq 9.0 and later. This new mode<br>
is very similar to the existing <code>(lang coq)</code>, except that it doesn't<br>
need the <code>coq*</code> compatibility wrappers. As of today <code>(lang rocq)</code><br>
doesn't support yet composed builds with Rocq itself, this will be<br>
added later.  <code>(lang coq)</code> is deprecated, development is frozen, and<br>
will be removed at some point in the future. (<a href="https://github.com/ocaml/dune/pull/12035" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3236816401" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12035" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12035/hovercard">#12035</a>, <a href="https://github.com/ejgallego" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ejgallego/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@ejgallego</a>,<br>
<a href="https://github.com/Lysxia" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Lysxia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@Lysxia</a>, fixes <a href="https://github.com/ocaml/dune/issues/11572" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="2949741933" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/11572" data-hovercard-type="issue" data-hovercard-url="/ocaml/dune/issues/11572/hovercard">#11572</a>)</p>
</li>
</ul>
<h3>Changed</h3>
<ul>
<li>
<p>Don't run <code>ocamldep</code> to compute false dependencies on the <code>root_module</code><br>
(<a href="https://github.com/ocaml/dune/pull/12227" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3335864092" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12227" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12227/hovercard">#12227</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p><code>dune format-dune-file</code> now uses the syntax version of the Dune project that<br>
contains the file being formatted (if any) instead of using the latest version<br>
available, which remains the default if there is no Dune project in scope.<br>
(<a href="https://github.com/ocaml/dune/pull/11865" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3090668217" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/11865" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/11865/hovercard">#11865</a>, <a href="https://github.com/nojb" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/nojb/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@nojb</a>)</p>
</li>
<li>
<p>Persistent DB and process events have been slightly modified. Persistent<br>
DB events have more concise names and job events always include full<br>
information. (<a href="https://github.com/ocaml/dune/pull/12867" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3698696255" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12867" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12867/hovercard">#12867</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>Removed the <code>--trace-extended</code> flag. Its functionality is always enabled when<br>
tracing is active (<a href="https://github.com/ocaml/dune/pull/12908" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3714267682" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12908" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12908/hovercard">#12908</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
<li>
<p>The <code>test/dune</code> file generated by <code>dune init proj</code> now depends on the project library. (<a href="https://github.com/ocaml/dune/pull/12791" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3665559843" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12791" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12791/hovercard">#12791</a>, <a href="https://github.com/shonfeder" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/shonfeder/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@shonfeder</a>)</p>
</li>
<li>
<p>Starting with version 3.21 of the Dune language, Dune no longer changes the<br>
default set of compiler warnings. For users that would like to keep the old<br>
behaviour, the variable <code>%{dune-warnings}</code> can be used in an <code>(env)</code> stanza in<br>
a top-level Dune file: <code>(env (dev (flags :standard %{dune-warnings})))</code>.<br>
(<a href="https://github.com/ocaml/dune/pull/12766" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3652438900" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12766" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12766/hovercard">#12766</a>, <a href="https://github.com/nojb" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/nojb/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@nojb</a>)</p>
</li>
<li>
<p>Fix: stop generating <code>cmt</code> files for cinaps binaries (<a href="https://github.com/ocaml/dune/pull/12530" class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="3484313448" data-permission-text="Title is private" data-url="https://github.com/ocaml/dune/issues/12530" data-hovercard-type="pull_request" data-hovercard-url="/ocaml/dune/pull/12530/hovercard">#12530</a>, <a href="https://github.com/rgrinberg" class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/rgrinberg/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self">@rgrinberg</a>)</p>
</li>
</ul>
