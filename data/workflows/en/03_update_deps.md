---
title: "Updating dependencies"
---

> **TL;DR**
> 
> If the project generates the `*.opam` file from the `dune-project`, add the dependency in the `package` stanza and run `opam install . --deps-only`.
> If the project does not generate the `*.opam` file, add the dependency in the `*.opam` file and run `opam install . --deps-only`.
To avoid duplicating the project configuration into multiple files, Dune allows to generate the `*.opam` file of the project from the 
package definitions in `dune-project` when adding the `(generate_opam_files true)` stanza.

However, opam remains a central piece of the ecosystem and it's very likely that you will have to work with `*.opam` files at some point,
so we don't take a stance on wether you should specify your dependencies in the `*.opam` file or in `dune-project`.

If the project generates the opam file from the `dune-project` (you can tell by the line `# This file is generated by dune, edit dune-project instead` at the top of the `*.opam` file), you can add your dependencies in the `dune-project` in the appropriate `package` stanza. It should look like this:

```
(package
 (name demo)
 (synopsis "A short, but powerful statement about your project")
 (description "An complete and exhaustive description everything your project does.")
 (depends
  (ocaml
   (>= 4.08.0))
  dune
  (alcotest :with-test)
  (odoc :with-doc)))
```

Once you have added your dependency, you can build your project with `dune build` which will re-generate the `*.opam` files.

If the `*.opam` files are not generated, you can add the dependencies in them directly, in the `depends` field. If should look like this:


```
opam-version: "2.0"
synopsis: "A short, but powerful statement about your project"
description: "An complete and exhaustive description everything your project does."
depends: [
  "ocaml" {>= "4.08.0"}
  "dune"
  "alcotest" {with-test}
  "odoc" {with-doc}
]
build: [
  ["dune" "subst"] {pinned}
  [
    "dune"
    "build"
    "-p"
    name
    "-j"
    jobs
    "@install"
    "@runtest" {with-test}
    "@doc" {with-doc}
  ]
]
```

Either way, once you have added your dependency in the appropriate file, you can run `opam install . --deps-only` to update your current switche's dependencies.
