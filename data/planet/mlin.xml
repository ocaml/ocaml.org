<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><id>http://www.blogger.com/feeds/3693082774051755513/posts/default/-/OCaml</id><title type="text">mlin</title><updated>2023-06-30T05:47:26-00:00</updated><entry><link href="http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html" rel="alternate"/><contributor><uri>http://www.blogger.com/feeds/3693082774051755513/posts/default/-/OCaml</uri><name>mlin</name></contributor><content type="html">&lt;b&gt;Update (Oct 2013):&lt;/b&gt; Anil &amp;nbsp;Madhavapeddy has &lt;a href=&quot;http://anil.recoil.org/2013/09/30/travis-and-ocaml.html&quot;&gt;fleshed this out further&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;
This evening I spent some time getting unit tests for my OCaml projects to run on &lt;a href=&quot;https://travis-ci.org/&quot;&gt;Travis CI&lt;/a&gt;, a free service for continuous integration on public GitHub projects. Although Travis has no built-in OCaml environment, it's straightforward to hijack its C environment to install OCaml and &lt;a href=&quot;http://opam.ocamlpro.com/&quot;&gt;OPAM&lt;/a&gt;, then build an OCaml project and run its tests.&lt;br/&gt;
&lt;br/&gt;
&lt;b&gt;1.&lt;/b&gt; Perform the &lt;a href=&quot;http://about.travis-ci.org/docs/user/getting-started/&quot;&gt;initial setup&lt;/a&gt; to get Travis CI watching your GitHub repo (up to and including step two of that guide).&lt;br/&gt;
&lt;br/&gt;
&lt;b&gt;2.&lt;/b&gt; Add a &lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;.travis.yml&lt;/span&gt; file to the root of your repo, with these contents:&lt;br/&gt;
&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;language: c&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;script: bash -ex travis-ci.sh&lt;/span&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;b&gt;3.&lt;/b&gt; Fill in &lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;travis-ci.sh&lt;/span&gt;, also in the repo root, with something like this:&lt;br/&gt;
&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;# OPAM version to install&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;export OPAM_VERSION=0.9.1&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;# OPAM packages needed to build tests&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;export OPAM_PACKAGES='ocamlfind ounit'&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;&lt;br/&gt;&lt;/span&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;# install ocaml from apt&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;sudo apt-get update -qq&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;sudo apt-get install -qq ocaml&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;&lt;br/&gt;&lt;/span&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;# install opam&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;curl -L https://github.com/OCamlPro/opam/archive/${OPAM_VERSION}.tar.gz | tar xz -C /tmp&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;pushd /tmp/opam-${OPAM_VERSION}&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;./configure&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;make&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;sudo make install&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;opam init&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;eval `opam config -env`&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;popd&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;&lt;br/&gt;&lt;/span&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;# install packages from opam&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;opam install -q -y ${OPAM_PACKAGES}&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;&lt;br/&gt;&lt;/span&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;# compile &amp;amp; run tests (here assuming OASIS DevFiles)&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;./configure --enable-tests&lt;/span&gt;&lt;br/&gt;
&lt;span style=&quot;font-family: Courier New, Courier, monospace; font-size: x-small;&quot;&gt;make test&lt;/span&gt;&lt;br/&gt;
&lt;div&gt;
&lt;br/&gt;&lt;/div&gt;
&lt;div&gt;
&lt;b&gt;4.&lt;/b&gt; Add and commit these two new files, and push to GitHub. Travis CI will then execute the tests.&lt;/div&gt;
&lt;div&gt;
&lt;br/&gt;&lt;/div&gt;
&lt;div&gt;
Working examples:&amp;nbsp;&lt;a href=&quot;https://github.com/mlin/forkwork&quot;&gt;ForkWork&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://github.com/mlin/yajl-ocaml&quot;&gt;yajl-ocaml&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
Installing OCaml and OPAM add less than two minutes of overhead, leaving plenty of room for your tests within the stated 15-20 minute time limit for open-source builds. I'm sure the above steps could be used as the basis for an eventual OCaml+OPAM environment built-in to Travis CI.&lt;/div&gt;
&lt;/div&gt;
&lt;br/&gt;</content><id>http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html</id><title type="text">Testing OCaml projects on Travis CI</title><updated>2013-02-11T04:18:00-00:00</updated><author><name>Unknown</name></author></entry></feed>