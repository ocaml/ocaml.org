---
title: Announcing MirageOS 3.9.0
description:
url: https://mirage.io/blog/announcing-mirage-39-release
date: 2020-10-27T00:00:00-00:00
preview_image:
authors:
- Martin Lucina
---


        <p>We are pleased to announce the release of MirageOS 3.9.0.</p>
<p>Our last release announcement was for <a href="https://mirage.io/blog/announcing-mirage-36-release">MirageOS 3.6.0</a>, so we will also cover changes since 3.7.x and 3.8.x in this announcement.</p>
<p>New features:</p>
<ul>
<li>The Xen backend has been <a href="https://github.com/mirage/mirage/issues/1159">re-written from scratch</a> to be based on Solo5, and now supports PVHv2 on Xen 4.10 or higher, and QubesOS 4.0.
</li>
<li>As part of this re-write, the existing Mini-OS based implementation has been retired, and all non-UNIX backends now use a unified OCaml runtime based on <code>ocaml-freestanding</code>.
</li>
<li>OCaml runtime settings settable via the <code>OCAMLRUNPARAM</code> environment variable are now exposed as unikernel boot parameters. For details, refer to <a href="https://github.com/mirage/mirage/pull/1180">#1180</a>.
</li>
</ul>
<p>Security posture improvements:</p>
<ul>
<li>With the move to a unified Solo5 and ocaml-freestanding base MirageOS unikernels on Xen gain several notable improvements to their overall security posture such as SSP for all C code, W^X, and malloc heap canaries. For details, refer to the mirage-xen 6.0.0 release <a href="https://github.com/mirage/mirage-xen/releases/tag/v6.0.0">announcement</a>.
</li>
</ul>
<p>API breaking changes:</p>
<ul>
<li>Several Xen-specific APIs have been removed or replaced, unikernels using these may need to be updated. For details, refer to the mirage-xen 6.0.0 release <a href="https://github.com/mirage/mirage-xen/releases/tag/v6.0.0">announcement</a>.
</li>
</ul>
<p>Other notable changes:</p>
<ul>
<li><code>Mirage_runtime</code> provides event loop enter and exit hook registration (<a href="https://github.com/mirage/mirage/pull/1010">#1010</a>).
</li>
<li>All MirageOS backends now behave similarly on a successful exit of the unikernel: they call <code>exit</code> with the return value 0, thus <code>at_exit</code> handlers are now executed (<a href="https://github.com/mirage/mirage/pull/1011">#1011</a>).
</li>
<li>The unix backend used a toplevel exception handler, which has been removed. All backends now behave equally with respect to exceptions.
</li>
<li>Please note that the <code>Mirage_net.listen</code> function still installs an exception handler, which will be removed in a future release. The out of memory exception is no longer caught by <code>Mirage_net.listen</code> (<a href="https://github.com/mirage/mirage/issues/1036">#1036</a>).
</li>
<li>To reduce the number of OPAM packages, the <code>mirage-*-lwt</code> packages are now deprecated. <code>Mirage_net</code> (and others) now use <code>Lwt.t</code> directly, and their <code>buffer</code> type is <code>Cstruct.t</code> (<a href="https://github.com/mirage/mirage/issues/1004">#1004</a>).
</li>
<li>OPAM files generated by <code>mirage configure</code> now include opam build and installation instructions, and also an URL to the Git <code>origin</code> (<a href="https://github.com/mirage/mirage/pull/1022">#1022</a>).
</li>
</ul>
<p>Known issues:</p>
<ul>
<li><code>mirage configure</code> fails if the unikernel is under version control and no <code>origin</code> remote is present (<a href="https://github.com/mirage/mirage/issues/1188">#1188</a>).
</li>
<li>The Xen backend has issues with event delivery if built with an Alpine Linux GCC toolchain. As a work-around, please use a Fedora or Debian based toolchain.
</li>
</ul>
<p>Acknowledgements:</p>
<ul>
<li>Thanks to Roger Pau Monn&eacute;, Andrew Cooper and other core Xen developers for help with understanding the specifics of how Xen PVHv2 works, and how to write an implementation from scratch.
</li>
<li>Thanks to Marek Marczykowski-G&oacute;recki for help with the QubesOS specifics, and for forward-porting some missing parts of PVHv2 to QubesOS version of Xen.
</li>
<li>Thanks to @palainp on Github for help with testing on QubesOS.
</li>
</ul>

      
