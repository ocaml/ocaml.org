---
title: Playing with .annot files
description: New commands are available in the OCaml mode of Chamo. They use the .annot  files
  generated by ocamlc. Here is a list of these commands. Def...
url: https://ocameleon.blogspot.com/2010/01/playing-with-annot-files.html
date: 2010-01-21T14:58:00-00:00
preview_image: //3.bp.blogspot.com/_RT8DPiBmxGY/S1hxkWOPSlI/AAAAAAAAAA8/ZuZjsQWDkJA/w1200-h630-p-k-no-nu/stack_calls.png
authors:
- Zoggy
source:
---

New commands are available in the OCaml mode of Chamo. They use the <span style="color: rgb(51, 102, 102);font-family:courier new;">.annot</span> files generated by ocamlc. Here is a list of these commands. Default key bindings are shown between parenthesis.<br/><br/><span style="color: rgb(51, 102, 255); font-weight: bold;font-family:courier new;">ocaml_display_type_annot (A-t)</span> already existed to display the type of the expression under the cursor. Now <span style="font-weight: bold; color: rgb(51, 102, 255);font-family:courier new;">ocaml_copy_type_annot (CA-t)</span> does the same but also copies the type in the clipboard so that it can be easily pasted somewhere else, for example in a <span style="color: rgb(51, 102, 102);font-family:courier new;">.mli</span> file. This prevents from having to launch a <span style="color: rgb(51, 102, 102);font-family:courier new;">ocamlc -i</span> command to get the type.<br/><br/><span style="color: rgb(51, 102, 255); font-weight: bold;font-family:courier new;">ocaml_display_ident_annot (A-i)</span><span style="font-family:courier new;"></span> displays the &quot;ident&quot; information, that is whether the identifier is local to the file or its fully qualified name if it is defined elsewhere. <span style="font-weight: bold; color: rgb(51, 102, 255);font-family:courier new;">ocaml_jump_to_local_def (A-j)</span> does the same but if the ident is defined in the file, the cursor is positioned on the identifier definition.<br/><br/><br/><span style="font-weight: bold; color: rgb(51, 102, 255);font-family:courier new;">ocaml_display_call_annot (A-c)</span> displays the &quot;call&quot; information, that is whether a function call is &quot;tail&quot; or &quot;stack&quot;. <span style="font-weight: bold; color: rgb(51, 102, 255);font-family:courier new;">ocaml_show_stack_calls (CA-c)</span> highlights (or not) all the calls using the stack. This can be useful to check whether a function is tail-recursive. The screenshot below shows the result on the <span style="color: rgb(51, 153, 153);font-family:courier new;">List</span> module.<br/><a href="http://3.bp.blogspot.com/_RT8DPiBmxGY/S1hxkWOPSlI/AAAAAAAAAA8/ZuZjsQWDkJA/s1600-h/stack_calls.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img src="http://3.bp.blogspot.com/_RT8DPiBmxGY/S1hxkWOPSlI/AAAAAAAAAA8/ZuZjsQWDkJA/s200/stack_calls.png" style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 200px; height: 174px;" alt="" border="0"/></a><br/>At last, <span style="font-weight: bold; color: rgb(51, 102, 255);font-family:courier new;">ocaml_expand_ext_idents (CA-x)</span> prompts the user to replace each external identifier by its fully qualified identifier (except for idents from <span style="font-family:courier new;">Pervasives</span>). I personnally use the <span style="color: rgb(51, 102, 102);font-family:courier new;">open</span> directive only not to prefix record fields and constructors, but always use fully qualified identifiers. This command is useful when working on a code not written by me and full of <span style="color: rgb(51, 102, 102);font-family:courier new;">open</span>'s at the beginning of a file.<br/><br/>All these commands are available from revision 745 of the repository and in the nightly snapshot.
