---
title: ' 8 Jul 2024'
description:
url: https://ryan.freumh.org/2024-07-08.html
date: 2024-07-08T00:00:00-00:00
preview_image:
authors:
- Ryan Gibb
source:
---

<article>
    <div class="container">
        <span>  Previous: <a href="https://ryan.freumh.org/2024-06-24.html">24 Jun 2024</a>  </span>
        <span>  Next: <a href="https://ryan.freumh.org/2024-08-05.html"> 5 Aug 2024</a>  </span>
    </div>
    
    <section>
        <p><span><a href="https://github.com/RyanGibb/opam-apk-repository">https://github.com/RyanGibb/opam-apk-repository</a></span></p>
<pre><code>a27b6fb1f2ab# opam repo add opam-apk-repository /opam-apk-repository
a27b6fb1f2ab# opam update
a27b6fb1f2ab# opam update
[WARNING] Running as root is not recommended

&lt;&gt;&lt;&gt; Updating package repositories &gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
[opam-apk-repository] synchronised from file:///opam-apk-repository
[default] no changes from https://opam.ocaml.org
Now run 'opam upgrade' to apply any package updates.
a27b6fb1f2ab# opam install nano
[WARNING] Running as root is not recommended
The following actions will be performed:
  - install ncurses-dev         6.4_p20240420-r0 [required by nano]
  - install ocaml-base-compiler 5.2.0
  - install nano                8.0-r0
  - install ocaml-config        3
  - install ocaml               5.2.0
  - install base-domains        base
  - install base-nnp            base
===== 7 to install =====
Do you want to continue? [Y/n] y

&lt;&gt;&lt;&gt; Processing actions &lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
-&gt; retrieved ocaml-config.3  (cached)
-&gt; retrieved ocaml-base-compiler.5.2.0  (cached)
-&gt; installed ncurses-dev.6.4_p20240420-r0
[ERROR] The compilation of ocaml-base-compiler.5.2.0 failed at "./configure --prefix=/root/.opam/default --docdir=/root/.opam/default/doc/ocaml -C".
-&gt; installed nano.8.0-r0

#=== ERROR while compiling ocaml-base-compiler.5.2.0 ==========================#
# context     2.1.6 | linux/x86_64 |  | https://opam.ocaml.org#5125fae2
# path        ~/.opam/default/.opam-switch/build/ocaml-base-compiler.5.2.0
# command     ~/.opam/default/.opam-switch/build/ocaml-base-compiler.5.2.0/./configure --prefix=/root/.opam/default --docdir=/root/.opam/default/doc/ocaml -C
# exit-code   77
# env-file    ~/.opam/log/ocaml-base-compiler-1357-42c309.env
# output-file ~/.opam/log/ocaml-base-compiler-1357-42c309.out
### output ###
# [...]
# configure: Configuring OCaml version 5.2.0
# checking build system type... x86_64-pc-linux-musl
# checking host system type... x86_64-pc-linux-musl
# checking target system type... x86_64-pc-linux-musl
# checking for csc... no
# checking for ld... ld
# checking how to print strings... printf
# checking for gcc... gcc
# checking whether the C compiler works... no
# configure: error: in `/root/.opam/default/.opam-switch/build/ocaml-base-compiler.5.2.0':
# configure: error: C compiler cannot create executables
# See `config.log' for more details



&lt;&gt;&lt;&gt; Error report &lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
+- The following actions failed
| - build ocaml-base-compiler 5.2.0
+-
+- The following changes have been performed (the rest was aborted)
| - install nano        8.0-r0
| - install ncurses-dev 6.4_p20240420-r0
+-

&lt;&gt;&lt;&gt; ocaml-base-compiler.5.2.0 troubleshooting &gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
=&gt; A failure in the middle of the build may be caused by build parallelism
      (enabled by default).
      Please file a bug report at https://github.com/ocaml/opam-repository/issues
=&gt; You can try installing again including --jobs=1
      to force a sequential build instead.
# Run eval $(opam env) to update the current shell environment

The former state can be restored with:
    /usr/bin/opam switch import "/root/.opam/default/.opam-switch/backup/state-20240711150233.export"</code></pre>
    </section>
</article>

